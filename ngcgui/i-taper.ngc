
(info: inner taper)
o<i-taper> sub
#<D_Start>              = #1 (= 10 Start Diameter)
#<D_End>                = #2 (= 20 Final Diameter)
#<Z_Start>              = #3 (= 0 Z Start)
#<Angle>                = #4 (= 10 Angle)
#<Depth_Cut>            = #5 (= 0.5 Depth of Cut)
#<Feed_Rate>            = #6 (= 30 Feed Rate)
#<Surface_Speed>        = #7 (= 30 Surface Speed)
#<Back_Travel_Offset>   = #8 (= 0.5 Back Travel Offset)
#<Max_RPM>              = #9 (= 1200 Max RPM)

; G43: toollength offset
; G7:  diameter mode
; G96: constant surface speed
G43 G7 G96 D#<Max_RPM> S#<Surface_Speed>

M3; start spindle

G0 Z#<Z_Start>
#<D_Current>=#<D_Start>

; ====== Cycle start
o101 while [#<D_Current> LT #<D_End>]

G0 X[#<D_Start> - #<Back_Travel_Offset>]

o1011   if [[#<D_Current>+#<Depth_Cut>] LT #<D_End>]
        #<D_Current>=[#<D_Current>+#<Depth_Cut>]
o1011   else
        #<D_Current>=#<D_End>
o1011   endif

#<Z_Current> = [[[#<D_Current> - #<D_Start>] / 2] / TAN[#<Angle>]]
(debug, Z_Current: #<Z_Current>)

G0 Z#<Z_Current>
X#<D_Start>

G1 X#<D_Current> Z#<Z_Start> F#<Feed_Rate> ; Main cut travel

o101 endwhile
; ====== Cycle end

M5; stop spindle


o<i-taper> endsub
